\hypertarget{_profiler_manager_8hpp_source}{}\doxysection{Profiler\+Manager.\+hpp}
\label{_profiler_manager_8hpp_source}\index{C:/Users/lllll/Documents/GitHub/UniEngine/include/lib/Engine/Managers/ProfilerManager.hpp@{C:/Users/lllll/Documents/GitHub/UniEngine/include/lib/Engine/Managers/ProfilerManager.hpp}}
\mbox{\hyperlink{_profiler_manager_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{_console_manager_8hpp}{ConsoleManager.hpp}}>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{_i_singleton_8hpp}{ISingleton.hpp}}>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <uniengine\_export.h>}}
\DoxyCodeLine{5 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_uni_engine}{UniEngine}}}
\DoxyCodeLine{6 \{}
\DoxyCodeLine{7 \textcolor{keyword}{class }UNIENGINE\_API \mbox{\hyperlink{class_uni_engine_1_1_i_profiler}{IProfiler}}}
\DoxyCodeLine{8 \{}
\DoxyCodeLine{9     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_uni_engine_1_1_profiler_manager}{ProfilerManager}};}
\DoxyCodeLine{10   \textcolor{keyword}{protected}:}
\DoxyCodeLine{11     std::string \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a5dd509d7597c0bca872ece20acb27858}{m\_name}};}
\DoxyCodeLine{12     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a12a715fb50afc5bc63baa6d9af335060}{PreUpdate}}() = 0;}
\DoxyCodeLine{13     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a041c099bd78070654c02ef645ccec6b7}{LateUpdate}}() = 0;}
\DoxyCodeLine{14     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a0a7b133437b64f0ff8d0374d6c8b01e0}{StartEvent}}(\textcolor{keyword}{const} std::string \&name) = 0;}
\DoxyCodeLine{15     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a5ae1ed4ff31dec22e9954e962408304c}{EndEvent}}(\textcolor{keyword}{const} std::string \&name) = 0;}
\DoxyCodeLine{16     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler_a9def9dc2a817fb029f58c04410e08f89}{OnInspect}}() = 0;}
\DoxyCodeLine{17 \};}
\DoxyCodeLine{18 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}}}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20     std::string \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a5bc86032c8965f6ca2d724ca02c86cca}{m\_name}} = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{21     \textcolor{keywordtype}{double} \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a106ea984bc0edf22966e0f50454bd94c}{m\_timeStart}} = 0;}
\DoxyCodeLine{22     \textcolor{keywordtype}{double} \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_ac3f0f03693c691dba8e540ff67a9df54}{m\_timeEnd}} = 0;}
\DoxyCodeLine{23     std::vector<CPUUsageEvent> \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a5401d150ad7367dfd414f9c06e6eebb8}{m\_children}};}
\DoxyCodeLine{24     \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}} *\mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a08604caf5164ce0bfa2ebb4fbf746c5f}{m\_parent}};}
\DoxyCodeLine{25     \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a3e54fbdee2805e859a096144017715d3}{CPUUsageEvent}}(\mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}} *parent, \textcolor{keyword}{const} std::string \&name);}
\DoxyCodeLine{26     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event_a76b4d66f190ff98903aad471e114994f}{OnInspect}}(\textcolor{keyword}{const} \textcolor{keywordtype}{float} \&parentTotalTime) \textcolor{keyword}{const};}
\DoxyCodeLine{27 \};}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{class }UNIENGINE\_API \mbox{\hyperlink{class_uni_engine_1_1_c_p_u_time_profiler}{CPUTimeProfiler}} : \textcolor{keyword}{public} \mbox{\hyperlink{class_uni_engine_1_1_i_profiler}{IProfiler}}}
\DoxyCodeLine{30 \{}
\DoxyCodeLine{31     \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}} m\_rootEvent = \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}}(\textcolor{keyword}{nullptr}, \textcolor{stringliteral}{"{}Main Loop"{}});}
\DoxyCodeLine{32     \mbox{\hyperlink{struct_uni_engine_1_1_c_p_u_usage_event}{CPUUsageEvent}} *m\_currentEventPointer = \&m\_rootEvent;}
\DoxyCodeLine{33     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_uni_engine_1_1_profiler_manager}{ProfilerManager}};}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   \textcolor{keyword}{protected}:}
\DoxyCodeLine{36     \textcolor{keywordtype}{void} PreUpdate() \textcolor{keyword}{override};}
\DoxyCodeLine{37     \textcolor{keywordtype}{void} StartEvent(\textcolor{keyword}{const} std::string \&name) \textcolor{keyword}{override};}
\DoxyCodeLine{38     \textcolor{keywordtype}{void} EndEvent(\textcolor{keyword}{const} std::string \&name) \textcolor{keyword}{override};}
\DoxyCodeLine{39     \textcolor{keywordtype}{void} LateUpdate() \textcolor{keyword}{override};}
\DoxyCodeLine{40     \textcolor{keywordtype}{void} OnInspect() \textcolor{keyword}{override};}
\DoxyCodeLine{41 \};}
\DoxyCodeLine{42 \textcolor{keyword}{class }UNIENGINE\_API \mbox{\hyperlink{class_uni_engine_1_1_profiler_manager}{ProfilerManager}} : \textcolor{keyword}{public} \mbox{\hyperlink{class_uni_engine_1_1_i_singleton}{ISingleton}}<ProfilerManager>}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44     std::map<size\_t, std::shared\_ptr<IProfiler>> m\_profilers;}
\DoxyCodeLine{45     \textcolor{keywordtype}{bool} m\_record = \textcolor{keyword}{false};}
\DoxyCodeLine{46   \textcolor{keyword}{public}:}
\DoxyCodeLine{47     \textcolor{keywordtype}{bool} m\_gui = \textcolor{keyword}{true};}
\DoxyCodeLine{48     \textcolor{keyword}{template} <\textcolor{keyword}{class} T = IProfiler> \textcolor{keyword}{static} std::shared\_ptr<T> GetOrCreateProfiler(\textcolor{keyword}{const} std::string \&name);}
\DoxyCodeLine{49     \textcolor{keyword}{template} <\textcolor{keyword}{class} T = IProfiler> \textcolor{keyword}{static} std::shared\_ptr<T> GetProfiler();}
\DoxyCodeLine{50     \textcolor{keyword}{static} \textcolor{keywordtype}{void} PreUpdate();}
\DoxyCodeLine{51     \textcolor{keyword}{static} \textcolor{keywordtype}{void} LateUpdate();}
\DoxyCodeLine{52     \textcolor{keyword}{static} \textcolor{keywordtype}{void} StartEvent(\textcolor{keyword}{const} std::string \&name);}
\DoxyCodeLine{53     \textcolor{keyword}{static} \textcolor{keywordtype}{void} EndEvent(\textcolor{keyword}{const} std::string \&name);}
\DoxyCodeLine{54     \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnInspect();}
\DoxyCodeLine{55 \};}
\DoxyCodeLine{56 \textcolor{keyword}{template} <\textcolor{keyword}{class} T> std::shared\_ptr<T> \mbox{\hyperlink{class_uni_engine_1_1_profiler_manager_ab2ab726bd5c0911d302553e063e97717}{UniEngine::ProfilerManager::GetProfiler}}()}
\DoxyCodeLine{57 \{}
\DoxyCodeLine{58     \textcolor{keyword}{auto} \&profilerManager = GetInstance();}
\DoxyCodeLine{59     \textcolor{keyword}{const} \textcolor{keyword}{auto} search = profilerManager.m\_profilers.find(\textcolor{keyword}{typeid}(T).hash\_code());}
\DoxyCodeLine{60     \textcolor{keywordflow}{if} (search != profilerManager.m\_profilers.end())}
\DoxyCodeLine{61         \textcolor{keywordflow}{return} std::dynamic\_pointer\_cast<T>(search-\/>second);}
\DoxyCodeLine{62     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{63 \}}
\DoxyCodeLine{64 \textcolor{keyword}{template} <\textcolor{keyword}{class} T> std::shared\_ptr<T> \mbox{\hyperlink{class_uni_engine_1_1_profiler_manager_ade4b94039e2332c79faf57faff343449}{UniEngine::ProfilerManager::GetOrCreateProfiler}}(\textcolor{keyword}{const} std::string \&name)}
\DoxyCodeLine{65 \{}
\DoxyCodeLine{66     \textcolor{keyword}{auto} profiler = GetProfiler<T>();}
\DoxyCodeLine{67     \textcolor{keywordflow}{if} (profiler != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{68         \textcolor{keywordflow}{return} profiler;}
\DoxyCodeLine{69     \textcolor{keyword}{auto} \&profilerManager = GetInstance();}
\DoxyCodeLine{70     profiler = std::make\_shared<T>();}
\DoxyCodeLine{71     profiler-\/>m\_name = name;}
\DoxyCodeLine{72     profilerManager.m\_profilers.insert(\{\textcolor{keyword}{typeid}(T).hash\_code(), profiler\});}
\DoxyCodeLine{73     \textcolor{keywordflow}{return} profiler;}
\DoxyCodeLine{74 \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \} \textcolor{comment}{// namespace UniEngine}}

\end{DoxyCode}
